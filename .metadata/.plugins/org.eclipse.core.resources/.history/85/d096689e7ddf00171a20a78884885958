package daa38.MapColoring;

import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;

public class ForestMapGenerator {

	
	private static class Position
	{
		int row,col;
		
		public Position(int pRow, int pCol)
		{
			row=pRow;
			col=pCol;
		}
		
		public Position up()
		{
			return new Position(row-1,col);
		}
	}

	private static class Forest
	{
		public static int[][] mMap;
		public static HashMap<Integer, Forest> mIntToForest = new HashMap<Integer,Forest>();
		
		public ArrayList<Position> mNext;
		public int mIndex;
		
		public Forest(Position pStart, int pIndex)
		{
			mNext = new ArrayList<Position>();
			mNext.add(pStart);
			mIndex = pIndex;
			
			mIntToForest.put(mIndex, this);
		}
		
		public boolean grow()
		{
			Collections.shuffle(mNext);
			while (!mNext.isEmpty())
			{
				int lIndex = mNext.size()-1;
				Position lPos = mNext.get(lIndex);
				mNext.remove(lIndex);
				
				if (mMap[lPos.row][lPos.col]==0)
				{
					mMap[lPos.row][lPos.col] = mIndex;

					
				}
			}
		}
	}
	
	private static ArrayList<Forest> fullRandomInitializeForests(int pNrForests, int[][] pMap)
	{	
		ArrayList<Forest> lForests = new ArrayList<Forest>();
		
		for (int lIndex=0; lIndex<pNrForests; lIndex++)
		{
			int lRow = (int) Math.floor(Math.random()*pMap.length);
			int lCol = (int) Math.floor(Math.random()*pMap[lRow].length);
			Forest lF = new Forest(new Position(lRow,lCol),lIndex);
			lForests.add(lF);
		}
		
		return lForests;
	}
	
	public static int[][] generateMap(int pNrZones, int pSize)
	{
		
		int[][] lMap = new int[pSize][pSize];
		
		for (int lRow = 0; lRow<pSize; lRow++)
		{
			for (int lCol = 0; lCol<pSize; lCol++)
			{
				lMap[lRow][lCol]=0;
			}
		}

		Forest.mMap = lMap;
		
		ArrayList<Forest> lForests = fullRandomInitializeForests(pNrZones,lMap);
		
		return lMap;
	}
}
