package daa38.Statistics.Auxiliary;

public class SyncMemoryConsumptionTracker {
	private long mConsumedBytes;
	private long mBytesUsedMax;
	private boolean mTracking;
	
	public SyncMemoryConsumptionTracker()
	{
		mConsumedBytes = 0;
		mTracking = true;
	}
	
	public synchronized void addBytes(long pBytes)
	{
		//System.out.println("Add bytes called with "+pBytes);
		if (mTracking)
			mConsumedBytes += pBytes;
		else
			System.out.println("But we finished tracking");
	}
	
	public synchronized void maxBytesUsed(long pBytes)
	{
		if (pBytes > mBytesUsedMax)
			mBytesUsedMax = pBytes;
	}
	
	public synchronized void endTracking()
	{
		//System.out.println("End tracking called");
		long lBytesAtEnd = Runtime.getRuntime().totalMemory() - Runtime.getRuntime().freeMemory();
		//System.out.println("Adding "+lBytesAtEnd);
		mConsumedBytes += lBytesAtEnd;
		if (lBytesAtEnd > mBytesUsedMax)
			mBytesUsedMax = lBytesAtEnd;
		mTracking = false;
	}
	
	public synchronized long getConsumedBytes()
	{
		return mConsumedBytes;
	}
	
	public synchronized long getMaxUsedBytes()
	{
		return mBytesUsedMax;
	}
	
}
